# WAS

(Web Application Server)

# Application/Session/Cookie

## application

사용범위 : 전역 범위에서 사용하는 저장 공간  
생명주기 : WAS가 시작해서 종료할 때 까지  
저장위치 : WAS 서버의 메모리

## session

사용범위 : 세션 범위에서 사용하는 저장 공간  
생명주기 : 세션이 시작해서 종료할 때 까지  
저장위치 : WAS 서버의 메모리

## cookie

사용범위 : Web Briwser별 지정한 path 범주 공간  
생명주기 : Browser에 전달한 시간부터 만료시간까지  
저장위치 : Web Browser의 메모리 또는 파일

생명 주기가 긴(1년) 데이터는 쿠키에 보관해야 한다.  
url로 전달되는 데이터는 쿠키에 보관해야 한다.

# 서버에서 페이지 전환해주기(redirection)

`resp.sendRedirect("calc2.html");`

# 동적인 페이지(서버 페이지)의 필요성

html은 정적인 페이지라 3 버튼을 눌러도 페이지에 동적으로 반영이 힘들기 때문에
요청이 들어오면 서버에서 동적인 문서를 만들어서 그것을 사용자에게 보내야 한다.

계산기 같은 격자형 프로그램을 만들 때에는 만들고자 하는 게 몇 행 몇 열인지 파악하고 table, tr, td로 구성

# JSP

add.jsp 파일을 Jasper가 서블릿 코드로 만든다.  
out.write .. 로 다 변환

서블릿 코드를 만듦에 있어서 jasper라는 도움자를 통해 서블릿을 만든다.  
jasper에게 일을 시키기 위해 만든 도구가 jsp.  
근데, jsp를 잘못하게 되면 코드 블럭이 복잡해진다.

코드 블록 : <% %>

- page 지시자 블럭

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
```

- 선언부

```
<%!
    public int sum(int a, int b)
    {
        return a + b;
    }
%>
```

## JSP 내장 객체

<p align="center"><img width="700" alt="내장객체" src="https://github.com/seohyoseok0408/study/assets/73714589/dd88146a-d051-4ece-a56d-cde0f26576c3">

- Jasper가 만든 서블릿에는 내장 객체들이 있다. (request, response...)

### 내장 객체 request : HttpServletRequest

<p align="center"><img width="700" alt="내장객체" src="https://github.com/seohyoseok0408/study/assets/73714589/d05eb21c-855e-4d2e-95f3-66ae5b05fe21">

### 내장 객체 response : HttpServletResponse

<p align="center"><img width="700" alt="내장객체" src="https://github.com/seohyoseok0408/study/assets/73714589/5cf16091-fbb2-4c3c-82f1-879ccb219a98">

### 내장 객체 session : javax.servlet.http.HttpSession

<p align="center"><img width="700" alt="내장객체" src="https://github.com/seohyoseok0408/study/assets/73714589/4d6e570d-4af5-4daa-a4a3-3f5d9c879cd9">

### 내장 객체 application : javax.servlet.ServletContext

<p align="center"><img width="700" alt="내장객체" src="https://github.com/seohyoseok0408/study/assets/73714589/ba0050cb-3b5f-418f-9336-e20c50373bbc">

## 장점

- 코드블럭만 책임지면 되고, 나머지 html은 jasper가 알아서 출력해준다.

## 단점

### 스파게티 코드를 만드는 JSP

순서만 맞다면, 코드블럭을 나눠서 만들 수도 있고 한곳에 합쳐서 만들 수도 있다.  
나눠서 만든다면, 어떤 블록이 어디서 오류가 났는지 등을 찾기가 어려워진다.  
스파게티 코드 : 내가 관심 있는 코드와 관심 없는 코드가 섞여있는 코드. (실타래 코드)  
-> 그래서 코드를 한 곳에 모아 놓는 게 더 바람직하다.

어떻게 효율적으로 만들 수 있을까? -> MVC Model1 방식

## MVC Model1

<p align="center"><img width="700" alt="효율적인 JSP" src="https://github.com/seohyoseok0408/study/assets/73714589/1c522ab8-222c-48d3-a294-ff98f8cd4e09">

- 오른쪽과 같이 한곳에만 코드블럭을 놓는다.
- 결과물, 산출물인 변수 model에다가 담아서 출력한다.
- <%=model%>도 코드 블럭이 들어가긴 하지만, 복잡한 로직이 없음. 단순히 출력
<br>
<br>
<p align="center"><img width="700" alt="MVC Model1" src="https://github.com/seohyoseok0408/study/assets/73714589/44f5abdb-2826-45f3-bfb6-bd1383c86fc3">

- Controller
  - 출력할 데이터를 만들어내는 과정을 갖고 있는 입력과 제어를 담당
- View
  - 출력 부분
- Model
  - 출력 데이터

장점

- 유지보수가 쉬워짐
- 출력을 관리하는 사람 또한 자바코드의 제어가 없어서 편하게 구성 가능

### Model1 방식을 만들 때 가장 중요한 것

- `자바 코드와 출력 코드를 최대한 분리`
